generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String         @id @unique @default(uuid())
  email            String         @unique
  password         String?
  role             Role           @default(GUEST)
  request_donation Boolean        @default(false)
  name             String?        @unique
  description      String?
  donor            Donation[]     @relation(name: "donor")
  recipient        Donation[]     @relation(name: "recipient")
  sender           Message[]      @relation(name: "sender")
  member           Organization[] @relation(name: "member")
  room             Room[]         @relation(name: "room")
}

model Donation {
  id                String        @id @unique @default(uuid())
  donor_id          String
  donor             User          @relation(name: "donor", fields: [donor_id], references: [id])
  recipient_id      String?
  recipient         User?         @relation(name: "recipient", fields: [recipient_id], references: [id])
  name              String        @unique
  description       String
  pickup_coordinate String?
  pickup_status     PickupStatus?
  tracking          Tracking[]    @relation(name: "tracking")
}

model Tracking {
  id          String   @id @unique @default(uuid())
  donation_id String
  donation    Donation @relation(name: "tracking", fields: [donation_id], references: [id])
  description String
  createdAt   DateTime @default(now())
}

model Room {
  id      String    @id @unique @default(uuid())
  user    User[]    @relation(name: "room")
  message Message[] @relation(name: "message")
}

model Message {
  id        String   @id @unique @default(uuid())
  sender_id String
  sender    User     @relation(name: "sender", fields: [sender_id], references: [id])
  content   String
  Room      Room     @relation(name: "message", fields: [room_id], references: [id])
  room_id   String
  createdAt DateTime @default(now())
}

model Organization {
  id        String  @id @unique @default(uuid())
  name      String  @unique
  organizer Event[] @relation(name: "event")
  user      User[]  @relation(name: "member")
}

model Event {
  id           String       @id @unique @default(uuid())
  organizer_id String
  organizer    Organization @relation(name: "event", fields: [organizer_id], references: [id])
  name         String       @unique
  date         DateTime     @default(now())
}

enum Role {
  ADMIN
  DONOR
  RECIPIENT
  VOLUNTEER
  GUEST
}

enum PickupStatus {
  RECIEVED
  CONFIRMED
  REJECTED
}
